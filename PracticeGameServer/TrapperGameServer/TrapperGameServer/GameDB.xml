<?xml version="1.0" encoding="utf-8"?>
<GameDB>
	<Table name="Player" desc="골드 테이블">
		<Column name="id" type="int" notnull="true" identity="1,1" />
		<Column name="playerId" type="nvarchar(50)" notnull="false" unique="true" />
		<Column name="playerPassword" type="nvarchar(50)" notnull="false" />
		<Column name="playerNickname" type="nvarchar(50)" notnull="false" />
		<Index type="clustered">
			<PrimaryKey/>
			<Column name="id" />
		</Index>
	</Table>

  <Procedure name="spInsertPlayer">
    <Param name="@playerId" type="nvarchar(50)"/>
    <Param name="@playerPassword" type="nvarchar(50)"/>
    <Param name="@playerNickname" type="nvarchar(50)"/>
    <Body>
      <![CDATA[
			INSERT INTO [dbo].[Player]([playerId], [playerPassword], [playerNickname]) VALUES(@playerId, @playerPassword, @playerNickname);
			]]>
    </Body>
  </Procedure>

  <Procedure name="spGetPlayer">
    <Body>
      <![CDATA[
			SELECT playerId, playerPassword FROM [dbo].[Player]
			]]>
    </Body>
  </Procedure>

  <Procedure name="spCheckPlayerIdExists">
    <Param name="@playerId" type="nvarchar(50)"/>
    <Body>
      <![CDATA[
        DECLARE @exists BIT;
        SET @exists = (SELECT CASE WHEN EXISTS (SELECT 1 FROM [dbo].[Player] WHERE [playerId] = @playerId) THEN 1 ELSE 0 END);
        SELECT @exists AS 'Exists';
        ]]>
    </Body>
  </Procedure>
  
   <Procedure name="spLoginPlayer">
        <Param name="@playerId" type="nvarchar(50)"/>
        <Param name="@playerPassword" type="nvarchar(50)"/>
        <Body>
            <![CDATA[
            DECLARE @result INT;

            IF NOT EXISTS (SELECT 1 FROM [dbo].[Player] WHERE [playerId] = @playerId)
            BEGIN
                SET @result = 2; -- ID가 존재하지 않음
            END
            ELSE
            BEGIN
                IF EXISTS (SELECT 1 FROM [dbo].[Player] WHERE [playerId] = @playerId AND [playerPassword] = @playerPassword)
                BEGIN
                    SET @result = 1; -- 로그인 성공
                END
                ELSE
                BEGIN
                    SET @result = 0; -- 비밀번호 틀림
                END
            END

            SELECT @result AS 'LoginResult';
            ]]>
        </Body>
    </Procedure>

  <Procedure name="spDeleteAllGold">
    <Body>
      <![CDATA[
        DELETE FROM [dbo].[Player];
        DBCC CHECKIDENT ('[dbo].[Player]', RESEED, 0);
        ]]>
    </Body>
  </Procedure>

</GameDB>